<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.8.3                                              -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.bio.ed.ac.uk/                                        -->
<beast>

	<!-- The list of taxa to be analysed (can also include dates/ages).          -->
	<!-- ntax=4                                                               -->
	<taxa id="taxa">
		<taxon id="A">
			<date value="1997.0" direction="forwards" units="years"/>
			<attr name="state">
				Asia
			</attr>
		</taxon>
		<taxon id="B">
			<date value="1995.0" direction="forwards" units="years"/>
			<attr name="state">
				West_Medit
			</attr>
		</taxon>
		<taxon id="C">
			<date value="2004.0" direction="forwards" units="years"/>
			<attr name="state">
				African
			</attr>
		</taxon>
		<taxon id="D">
			<date value="2000.0" direction="forwards" units="years"/>
			<attr name="state">
				Asia
			</attr>
		</taxon>
	</taxa>


	<newick id="startingTree">
		((A:0.1,B:0.2):0.3,(C:0.4,D:0.5):0.6);
	</newick>

	<!-- general data type for discrete trait model, 'state'                     -->
	<generalDataType id="state.dataType">                                             
		<state code="Asia"/>
		<state code="West_Medit"/>
		<state code="African"/>
<!--		<ambiguity code="WesternArea" states="African Asia"/>-->
<!--		<ambiguity code="WesternArea" states="African Asia" value = "0.7 0.3"/>-->
	</generalDataType>


	<!-- Data pattern for discrete trait, 'state'                                -->
	<attributePatterns id="state.pattern" attribute="state">
		<taxa idref="taxa"/>
		<generalDataType idref="state.dataType"/>
	</attributePatterns>

	<!-- END Discrete Traits Model                                               -->


	<!-- Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<coalescentTree idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>


	<!-- The strict clock (Uniform rates across branches)                        -->
	<strictClockBranchRates id="state.branchRates">
		<rate>
			<parameter id="state.clock.rate" value="1.0" lower="0.0"/>
		</rate>
	</strictClockBranchRates>
	<rateStatistic id="state.meanRate" name="state.meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<strictClockBranchRates idref="state.branchRates"/>
	</rateStatistic>


	<!-- asymmetric CTMC model for discrete state reconstructions                -->
	<complexSubstitutionModel id="state.model" randomizeIndicator="false" normalized="false" scaleRatesByFrequencies="false">
		<generalDataType idref="state.dataType"/>
		<frequencies>
			<frequencyModel id="state.frequencyModel" normalize="true">
				<generalDataType idref="state.dataType"/>
				<frequencies>
					<parameter id="state.frequencies" dimension="3"/>
				</frequencies>
			</frequencyModel>
		</frequencies>

		<!-- rates and indicators                                                    -->
		<rates>
			<parameter id="state.rates" dimension="6" value="1.0"/>
		</rates>
	</complexSubstitutionModel>
	
	<siteModel id="state.siteModel">
		<substitutionModel>
			<generalSubstitutionModel idref="state.model"/>
		</substitutionModel>
	</siteModel>

	
	<structuredCoalescent type="BASTA" id="state.treeLikelihood" stateTagName="state.states" useBEAGLE = "true">
		<attributePatterns idref="state.pattern"/>
		<treeModel idref="treeModel"/>
		<!-- <siteModel idref="state.siteModel"/> -->
		<complexSubstitutionModel idref="state.model"/>
		<strictClockBranchRates idref="state.branchRates"/>
		<parameter id="structured.popSizes" value="0.01 0.05 0.001" lower="0.0"/>
	</structuredCoalescent>

	<report>
		<structuredCoalescentLikelihood idref="state.treeLikelihood"/>
	</report>
</beast>
