<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.8.3                                              -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.bio.ed.ac.uk/                                        -->
<beast>

	<!-- The list of taxa to be analysed (can also include dates/ages).          -->
	<!-- ntax=372                                                                -->
	<taxa id="taxa">
		<taxon id="A">
			<date value="2005" direction="forwards" units="years"/>
			<attr name="host">
				Ap
			</attr>
			<attr name="state">
				Arizona
			</attr>
		</taxon>
		<taxon id="B">
			<date value="2004" direction="forwards" units="years"/>
			<attr name="host">
				Ef
			</attr>
			<attr name="state">
				Florida
			</attr>
		</taxon>
		<taxon id="C">
			<date value="2005" direction="forwards" units="years"/>
			<attr name="host">
				Ef
			</attr>
			<attr name="state">
				Florida
			</attr>
		</taxon>
		<taxon id="D">
			<date value="2002" direction="forwards" units="years"/>
			<attr name="host">
				Ef
			</attr>
			<attr name="state">
				California
			</attr>
		</taxon>
		<taxon id="E">
			<date value="2002" direction="forwards" units="years"/>
			<attr name="host">
				Ef
			</attr>
			<attr name="state">
				California
			</attr>
		</taxon>
	</taxa>

	<!-- The sequence alignment (each sequence refers to a taxon above).         -->
	<!-- ntax=372 nchar=1353                                                     -->
	<alignment id="alignment" dataType="nucleotide">
		<sequence>
			<taxon idref="A"/>
			ATGGATGCCGACAAGATTGTATTTAAAGTCAATAATCAGGTGGTTTCTCTGAAGCCTGAGATTATCGTTGATCAATATGAGTACAAGTACCCGGCTATCAAGGACTTGAAGAAGCCCAGTATAACCTTAGGAAAAGCCCCTGATTTGAACAAAGCATACAAGTCAATTTTATCCGGCATGAATGCAGCCAAGCTTGACCCAGATGATGTATGTTCTTATCTGGCAGCTGCAATGCAGTTCTTTGAGGGAGCATGCCCTGATGACTGGACCAGCTATGGAATCCTGATTGCACGGAGGGGAGACAAGATCACTCCAGACTCTCTTGTAGACATAAAACGTACTCATGTGGAAGGGAATTGGGCTCTAACAGGGGGTATGGAGTTGACGAGAGATCCTACCGTTTCGGAGCATGCATCTTTAGTTGGTCTTCTCTTGAGTCTGTATAGGTTGAGCAAAATATCTGGACAAAACACCGGCAACTACAAAACAAACATCGCGGATAGAATAGAGCAGATTTTCGAGACGGCCCCCTTTGTAAAGATCGTGGAACATCATACTTTGATGACAACCCATAAGATGTGCGCTAACTGGAGCACCATACCGAACTTCAGATTCCTAGCTGGGACTTACGATATGTTTTTCTCCCGGATTGAACATCTGTATTCAGCAATTAGAGTGGGAACAGTTGTCACTGCTTACGAGGACTGCTCAGGGTTGGTGTCGTTTACAGGGTTTATAAAGCAAATAAACCTCACTGCAAGAGAGGCAATACTGTATTTCTTCCACAAGAACTTCGAGGAAGAGATAAGAAGAATGTTTGAGCCGGGGCAAGAAACCGCAGTTCCTCACTCCTATTTCATCCATTTTCGTTCGTTGGGCCTGAGTGGGAAATCTCCGTATTCATCAAATGCAGTCGGTCACGTGTTCAACCTCATTCACTTTGTTGGATGTTATATGGGTCAAGTGAGATCTTTGAATGCAACAGTCATTGCCACATGTGCCCCGCATGAGATGTCTGTTCTTGGGGGTTATCTGGGGGAGGAGTTTTTTGGAAAAGGGACTTTTGAAAGAAGATTCTTCAGGGATGAGAAAGAACTTCAGGAACATGAGGCAGCTGAATTAACGAAGATTGAGGTGGCCTTGGCAGATGACGGAACAGTCAATTCTGATGACGAGGACTACTTCTCTAGTGAGACCAGGAGTCCAGAGGCAGTTTATACCCGAATCATGATGAATGGAGGTAGACTAAAAAGATCACACATAAGGAGATATGTCTCAGTTAGTTCCAATCATCAAGCTCGCCCTAATTCATTCGCTGAGTTTCTAAACAAGACATACTCGAGTGATTCTTGA
		</sequence>
		<sequence>
			<taxon idref="B"/>
			ATGGATGCCGACAAGATTGTATTCAAAGTCAATAATAAGGTGGTCTCTCTGAAGCCTGAAATTATCGTGGACCAGTATGAGTACAAGTACCCGGCTATCAAGGACTTAAAGAAGCCCAGTATAACCTTAGGAAAAGCCCCTGACTTGAACAAAGCATACAAATCAGTTTTATCTGGCATGAATGCAGCCAAGCTCGACCCTGATGATGTATGCTCTTATCTAGCAGCCGCAATGCAGTTCTTTGAGGGGGCATGTCCTGATGACTGGACCAGCTACGGAATCCTGATAGCACGGAGGGGAGACAAGATCACCCCAAATTCTCTTGTGGACATAAGACGCACCGATGTGGAAGGGAATTGGGCTCTAACAGGAGGTATGGAGTTAACGAGAGACCCCACTGTTTCGGAGCATGCATCTTTGGTTGGTCTTCTCTTGAGTCTGTATAGGTTGAGCAAAATATCTGGACAGAACACCGGCAATTACAAGACAAACATCGCAGATAGGATAGAGCAGATTTTCGAAACAGCCCCTTTTGTAAAGATCGTAGAACATCATACTTTGATGACAACCCACAAAATGTGCGCCAACTGGAGTACCATACCGAACTTCAGATTCCTAGCCGGGACATATGACATGTTTTTCTCCCGGATTGAACATCTATATTCAGCGATTAGAGTGGGCACAGTTGTCACTGCTTATGAGGACTGCTCAGGGTTGGTGTCATTTACAGGGTTTATAAAGCAAATAAATCTCACTGCGAGAGAAGCACTACTATATTTCTTCCACAAGAACTTTGAAGAAGAGATAAGAAGAATGTTTGAGCCGGGGCAAGAGACTGCAGTTCCTCACTCCTATTTCATCCATTTCCGTTCGTTGGGCCTGAGCGGGAAATCTCCGTACTCATCAAATGCAGTTGGTCATGTGTTCAACCTCATTCACTTTGTTGGATGTTATATGGGTCAGGTGAGATCTCTGAATGCAACAGTGATTGCCACATGTGCCCCACATGAGATGTCTGTTCTTGGGGGTTATTTGGGGGAGGAGTTTTTTGGAAAAGGGACTTTTGAGAGAAGATTCTTCAGGGACGAGAAAGAACTTCAGGAATATGAGGCAGCTGAATCAACTAAGACTGAAGTAGCCTTGGCTGATGACGGAACCGTCAATTCTGATGACGAGGACTACTTCTCTAGTGAGACCAGGAGTCCGGAGGCAGTCTACACTCGAATCATGATGAATGGAGGTAGACTGAAAAGATCACACATAAGGAGGTATGTCTCAGTCAGCTCCAATCATCAAGCTCGCCCCAACTCATTCGCCGAGTTTTTAAACAAGACATACTCGAGTGATTCATAA
		</sequence>
		<sequence>
			<taxon idref="C"/>
			ATGGATGCCGACAAGATTGTATTTAAAGTCAAGAATCAGGTGGTCTCCTTGAAGCCTGAGATCATTGTGGACCAATATGAATACAAGTACCCGGCAATCAAGGACTCGAGGAAGCCCAGTATAACCTTGGGAAAAGCCCCTGACTTAAACAAAGCATACAAGTCAATTTTGTCTGGCATGAATGCAGCCAAGCTCGATCCTGACGATGTATGCTCTTATCTAGCAGCTGCAATGCAGTTCTTTGAGGGAGCATGTCCCGATGACTGGATTAGCTACGGAATCCTGATAGCACGGAAAGGCGACAAGATCACCCCCGGCTCTCTTGTGGATATAAGACGTACCAATGTAGAGGGGAGTTGGGCTCTGACAGGGGGTATGGAGTTGACAAGAGATCCCACTGTTCCAGAGCATGCATCCTTGGTCGGTCTTCTCTTGAGTTTGTATAGGTTGAGCAAAATATCAGGACAGAACACTGGCAATTACAAGACAAACATAGCAGACAGAATAGAGCAAATTTTCGAGACAGCCCCTTTTGTCAAGATTGTAGAGCATCATACTTTGATGACAACCCACAAAATGTGCGCCAACTGGAGTACCATACCGAACTTCAGATTCTTAGCCGGAACCTATGACATGTTCTTCTCCCGGATTGAACATCTGTATTCAGCAATTAGGGTAGGCACAGTAGTTACTGCTTATGAGGACTGCTCAGGGTTGGTGTCTTTTACAGGGTTCATAAAGCAAATAAATCTCACTGCAAGAGAAGCGCTGCTATACTTCTTCCACAAGAACTTCGAAGAAGAAATAAGAAGGATGTTTGAGCCGGGGCAGGAAACTGCAGTTCCTCACTCTTATTTCATCCATTTTCGCTCATTAGGCCTGAGCGGGAAGTCTCCATACTCATCGAATGCGGTTGGTCATGTTTTCAACCTCATTCACTTTGTTGGATGTTACATGGGCCAAGTGAGATCTCTGAATGCAACGGTTATTGCTACATGTGCCCCACATGAGATGTCTGTTCTCGGGGGTTACTTAGGGGAGGAGTTTTTTGGAAAAGGGACTTTTGAGAGAAGATTCTTCAGGGATGAGAAGGAACTTCAAGAATATGAAGCAGCTGAACTGACCAAGACAGAAGTGGCTTTGGCAGATGACGGAACCGTCAACTCTGATGATGAGGACTACTTCTCAAGTGAGACCAGGAGTCCTGAGGCGGTTTATACCCGAATCATGATGAATGGAGGTAGATTGAAAAGATCACACATAAGGAGGTATGTCTCAGTCAGCTCCAATCATCAGGCACGTCCTAACTCATTCGCTGAATTTTTGAACAAGACATACTCAAGTGATTCTTAA
		</sequence>
		<sequence>
			<taxon idref="D"/>
			ATGGATGCCGACAAGATTGTATTCAAAGTCAATAATCGGGTGGTCTCTCTGAAGCCTGAAATTATAGTGGATCAATATGAGTACAAGTACCCGGCTATCAAGGACTTGAAAAAGCCCAGTATAACCTTAGGAAAAGCCCCTGACTTAAACAAAGCATACAAATCAGTGTTGTCCGGCATGAATGCAGCCAAGCTTGACCCTGATGATGTATGCTCTTATCTAGCAGCCGCAATGCAGTTCTTTGAGGGAGCATGTCCTGATGACTGGACCAGCTATGGAATCCTGATAGCACGGAAGGGAGACAAGATCACCCCAAATTCTCTTGTGGACATAAAACGTACCAATGTGGAAGGGAATTGGGCTCTAACAGGGGGCATGGAGTTGACGAGGGACCCCACTGTTTCGGAGCATGCATCTTTGGTTGGTCTTCTCTTGAGTCTGTATAGGTTGAGCAAAATATCAGGACAGAATACCGGCAATTATAAGACAAACATCGCAGATAGGATAGAGCAGATTTTCGAAACAGCCCCTTTTGTAAAGATCGTAGAACATCATACTCTGATGACAACTCACAAGATGTGCGCTAACTGGAGTACAATACCGAACTTCAGATTCCTAGCCGGGACCTATGACATGTTTTTCTCCCGGATTGAACATCTGTATTCAGCGATTAGAGTAGGCACAGTTGTCACTGCTTATGAGGACTGCTCAGGGTTGGTATCATTTACAGGGTTTATAAAGCAAATAAATCTCACAGCGAGAGAAGCACTACTATATTTCTTCCACAAGAACTTTGAAGAAGAGATAAGAAGAATGTTTGAGCCGGGGCAAGAGACTGCAGTTCCTCACTCCTATTTCATCCATTTTCGTTCGTTGGGCCTGAGCGGGAAATCTCCGTACTCCTCAAATGCAGTTGGTCATGTGTTCAACCTCATTCACTTTGTTGGATGTTATATGGGTCAAGTGAGATCTCTGAATGCAACAGTGATTGCCACATGTGCCCCGCACGAGATGTCTGTTCTTGGGGGTTATTTGGGAGAGGAGTTTTTTGGGAAAGGGACTTTTGAAAGAAGATTCTTCAGGGACGAGAAAGAACTTCAGGAATATGAAGCAGCTGAATTAACGAAGACTGAAGTAGCCCTGGCGGATGACGGAACCGTCAATTCTGATGACGAGGACTACTTCTCTAGTGAGACCAGGAGTCCGGAGGCAGTTTACACTCGAATCATGATGAATGGAGGCAGACTGAAAAGATCACACATCAGGAGGTATGTCTCAGTCAGCTCCAATCATCAAGCTCGCCCCAACTCATTCGCAGAGTTTTTAAACAAGACATACTCGAATGATTCGTAA
		</sequence>
		<sequence>
			<taxon idref="E"/>
			ATGGATGCCGACAAGATTGTATTCAAAGTCAATAATCGGGTGGTCTCTCTGAAGCCTGAAATTATAGTGGATCAATATGAGTACAAGTACCCGGCTATCAAGGACTTGAAAAAGCCCAGTATAACCTTAGGAAAAGCCCCTGACTTGAACAAAGCATACAAATCAGTGTTGTCCGGCATGAATGCAGCCAAGCTCGACCCTGATGATGTATGCTCTTATCTAGCAGCCGCAATGCAGTTCTTTGAGGGAGCATGTCCTGATGACTGGACCAGCTATGGAATCCTGATAGCACGGAAGGGAGACAAGATCACCCCAAATTCTCTTGTGGACATAAAGCGTACCAATGTGGAAGGGAATTGGGCTCTAACAGGGGGCATGGAGTTGACGAGGGACCCCACTGTTTCGGAGCATGCATCTTTGGTTGGTCTTCTCTTGAGTCTGTATAGGTTGAGCAAAATATCAGGACAGAATACCGGCAATTATAAGACAAACATCGCAGATAGGATAGAGCAGATTTTCGAAACAGCCCCTTTTGTAAAGATCGTAGAACATCATACTCTGATGACAACTCACAAGATGTGCGCTAACTGGAGTACAATACCGAACTTCAGATTCCTAGCCGGGACCTATGACATGTTTTTCTCCCGGATTGAACATCTGTATTCAGCAATTAGAGTAGGCACAGTTGTCACTGCTTATGAGGACTGCTCAGGGTTGGTATCATTTACAGGGTTTATAAAGCAAATAAATCTCACAGCGAGAGAAGCACTACTATATTTCTTCCACAAGAACTTTGAAGAAGAGATAAGAAGAATGTTTGAGCCGGGGCAAGAGACTGCAGTTCCTCACTCCTATTTCATCCATTTTCGTTCGTTGGGCCTGAGCGGGAAATCTCCGTACTCCTCAAATGCAGTTGGTCATGTGTTCAACCTCATTCACTTTGTTGGATGTTATATGGGTCAAGTGAGATCTCTGAATGCAACAGTGATTGCCACATGTGCCCCGCACGAGATGTCTGTTCTTGGGGGTTATTTGGGAGAGGAGTTTTTTGGGAAAGGGACTTTTGAGAGAAGATTCTTCAGGGACGAGAAAGAACTTCAGGAATATGAAGCAGCTGAATTAACGAAGACTGAAGTAGCCCTGGCGGATGACGGAACCGTCAATTCTGATGACGAGGACTACTTCTCTAGTGAGACCAGGAGTCCGGAGGCAGTTTACACTCGAATCATGATGAATGGAGGCAGACTGAAAAGATCACACATCAGGAGGTATGTCTCAGTCAGCTCCAATCATCAAGCTCGCCCCAACTCATTCGCAGAGTTTTTAAACAAGACATACTCGAATGATTCGTAA
		</sequence>
		
	</alignment>

	<!-- The unique patterns from 1 to end                                       -->
	<!-- npatterns=548                                                           -->
	<patterns id="patterns" from="1" strip="false">
		<alignment idref="alignment"/>
	</patterns>


	<!-- general data type for discrete trait model, 'state'                     -->
	<generalDataType id="state.dataType">

		<!-- Number Of States = 14                                                   -->
		<state code="Arizona"/>
		<state code="California"/>
		<state code="Florida"/>
		<state code="Washington"/>
	</generalDataType>


	<!-- Data pattern for discrete trait, 'state'                                -->
	<attributePatterns id="state.pattern" attribute="state">
		<taxa idref="taxa"/>
		<generalDataType idref="state.dataType"/>
	</attributePatterns>

	<!-- END Discrete Traits Model                                               -->


	<!-- A prior assumption that the population size has remained constant       -->
	<!-- throughout the time spanned by the genealogy.                           -->
	<constantSize id="constant" units="years">
		<populationSize>
			<parameter id="constant.popSize" value="40" lower="0.0"/>
		</populationSize>
	</constantSize>
	<!-- Generate a random starting tree under the coalescent process            -->
<!-- 
	<coalescentSimulator id="startingTree">
		<taxa idref="taxa"/>
		<constantSize idref="constant"/>
	</coalescentSimulator>
 -->
 
 	<newick id="startingTree" usingHeights="true" usingDates="false">
		(((A:2,B:1):2,C:4):1,(D:1.5,E:1.5):0.5) ;
 	</newick>

	<!-- Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<newick idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>

	<!-- Generate a coalescent likelihood                                        -->
	<!-- <coalescentLikelihood id="coalescent">
		<model>
			<constantSize idref="constant"/>
		</model>
		<populationTree>
			<treeModel idref="treeModel"/>
		</populationTree>
	</coalescentLikelihood> -->

	<strictClockBranchRates id="state.branchRates">
		<rate>
			<parameter id="state.clock.rate" value="0.0001" lower="0.0"/>
		</rate>
	</strictClockBranchRates>
	<rateStatistic id="state.meanRate" name="state.meanRate" mode="mean" internal="true" external="true">
		<treeModel idref="treeModel"/>
		<strictClockBranchRates idref="state.branchRates"/>
	</rateStatistic>


	<!-- Likelihood for tree given sequence data                                 -->


	<generalSubstitutionModel id="state.model" randomizeIndicator="false" normalized ="false">
		<generalDataType idref="state.dataType"/>
		<frequencies>
			<frequencyModel id="state.frequencyModel">
				<generalDataType idref="state.dataType"/>
				<frequencies>
					<parameter id="state.frequencies" dimension="4"  value = "0.15 0.2 0.35 0.3"/>
				</frequencies>
			</frequencyModel>
		</frequencies>

		<!-- rates and indicators                                                    -->
		<rates>
			<parameter id="state.rates" dimension="12" value="1.0"/>
		</rates>
	</generalSubstitutionModel>


	<structuredCoalescent type="BASTA" id="state.treeLikelihood" stateTagName="state.states">
		<attributePatterns idref="state.pattern"/>
		<treeModel idref="treeModel"/>
		<!-- <siteModel idref="state.siteModel"/> -->
		<generalSubstitutionModel idref="state.model"/>
		<strictClockBranchRates idref="state.branchRates"/>
		<parameter id="structured.popSizes" dimension="4" value="0.25" lower="0.0"/>

		<!-- The root state frequencies                                              -->
		<!-- <frequencyModel id="state.root.frequencyModel" normalize="true">
			<generalDataType idref="state.dataType"/>
			<frequencies>
				<parameter id="state.root.frequencies" dimension="14"/>
			</frequencies>
		</frequencyModel> -->
	</structuredCoalescent>

	<structuredCoalescentLikelihoodGradient id="gradient.1" wrtParameter="migrationRate" >
		<structuredCoalescent idref="state.treeLikelihood"/>
		<glmSubstitutionModel idref="state.model"/>
	</structuredCoalescentLikelihoodGradient>

		<structuredCoalescentLikelihoodGradient id="gradient.2" wrtParameter="populationSize" >
			<structuredCoalescent idref="state.treeLikelihood"/>
			<glmSubstitutionModel idref="state.model"/>
		</structuredCoalescentLikelihoodGradient>

	<report>
		<structuredCoalescentLikelihoodGradient idref="gradient.1"/>
	</report>

	<report>
		<structuredCoalescentLikelihoodGradient idref="gradient.2"/>
	</report>
</beast>
