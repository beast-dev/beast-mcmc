<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.10.5 Prerelease #23570d1                         -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.community/                                           -->

<beast version="1.10.5">

    <taxa id="taxa">
        <taxon id="A"/>
        <taxon id="B"/>
        <taxon id="C"/>
        <taxon id="D"/>
    </taxa>


    <newick id="startingTree" usingHeights="true" usingDates="false">
        ((A:1.0,B:2.0):1.0,(C:1.0,D:2.0):2.0)
    </newick>


    <!-- Generate a tree model                                                   -->
    <treeModel id="treeModel">
        <newick idref="startingTree"/>
        <rootHeight>
            <parameter id="treeModel.rootHeight"/>
        </rootHeight>
        <nodeHeights internalNodes="true">
            <parameter id="treeModel.internalNodeHeights"/>
        </nodeHeights>
        <nodeHeights internalNodes="true" rootNode="true">
            <parameter id="treeModel.allInternalNodeHeights"/>
        </nodeHeights>
    </treeModel>

    <!-- Statistic for sum of the branch lengths of the tree (tree length)       -->
    <treeLengthStatistic id="treeLength">
        <treeModel idref="treeModel"/>
    </treeLengthStatistic>


    <!-- ########## -->
    <!-- # CASE 1 # -->
    <!-- ########## -->

<!--    &lt;!&ndash; multiple rates model with three intervals &ndash;&gt;-->
<!--    <newBirthDeathSerialSampling id="new.bdss1" units="years" hasFinalSample="false" conditionOnSurvival="false">-->
<!--        <birthRate>-->
<!--            <parameter id="bdss1.birthRate" value ="8.47 2.88 1.82" lower="0.0"/>-->
<!--        </birthRate>-->
<!--        <deathRate>-->
<!--            <parameter id="bdss1.deathRate" value ="4.89 2.67 3.23" lower="0.0"/>-->
<!--        </deathRate>-->
<!--        <samplingRate>-->
<!--            <parameter id="bdss1.samplingRate" value ="3.42 2.95 1.21" lower="0.0"/>-->
<!--        </samplingRate>-->
<!--        <samplingProbability>-->
<!--            <parameter id="bdss1.samplingProbability" value ="0.07  0.22  0.18" lower="0.0" upper="1.0"/>-->
<!--        </samplingProbability>-->
<!--        <treatmentProbability>-->
<!--            <parameter id="bdss1.treatmentProbability" value ="0.89 0.93 0.79" lower="0.0" upper="1.0"/>-->
<!--        </treatmentProbability>-->
<!--        <origin>-->
<!--            <parameter id="bdss1.origin" value="5.123" lower="0.0"/>-->
<!--        </origin>-->
<!--        <cutOff>-->
<!--            <parameter value="5.123"/>-->
<!--        </cutOff>-->
<!--        <numGridPoints>-->
<!--            <parameter value="3"/>-->
<!--        </numGridPoints>-->
<!--    </newBirthDeathSerialSampling>-->

<!--    <speciationLikelihood id="speciation1" useNewLoop="true">-->
<!--        <model>-->
<!--            <newBirthDeathSerialSampling idref="new.bdss1"/>-->
<!--        </model>-->
<!--        <speciesTree>-->
<!--            <treeModel idref="treeModel"/>-->
<!--        </speciesTree>-->
<!--    </speciationLikelihood>-->

<!--    <speciationLikelihoodGradient id="grad.birthRate1" wrtParameter="birthRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation1"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.deathRate1" wrtParameter="deathRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation1"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.samplingRate1" wrtParameter="samplingRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation1"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.samplingProbability1" wrtParameter="samplingProbability" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation1"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.treatmentProbability1" wrtParameter="treatmentProbability" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation1"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->


<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.birthRate1"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.deathRate1"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.samplingRate1"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.samplingProbability1"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.treatmentProbability1"/>-->
<!--    </report>-->

<!--    &lt;!&ndash; ########## &ndash;&gt;-->
<!--    &lt;!&ndash; # CASE 2 # &ndash;&gt;-->
<!--    &lt;!&ndash; ########## &ndash;&gt;-->

<!--    &lt;!&ndash; multiple rates model with three intervals and one intensive sampling event at t1 = 2 &ndash;&gt;-->
<!--    <newBirthDeathSerialSampling id="new.bdss2" units="years" hasFinalSample="false" conditionOnSurvival="false">-->
<!--        <birthRate>-->
<!--            <parameter id="bdss2.birthRate" value ="8.47 2.88 1.82" lower="0.0"/>-->
<!--        </birthRate>-->
<!--        <deathRate>-->
<!--            <parameter id="bdss2.deathRate" value ="4.89 2.67 3.23" lower="0.0"/>-->
<!--        </deathRate>-->
<!--        <samplingRate>-->
<!--            <parameter id="bdss2.samplingRate" value ="3.42 2.95 1.21" lower="0.0"/>-->
<!--        </samplingRate>-->
<!--        <samplingProbability>-->
<!--            <parameter id="bdss2.samplingProbability" value ="0.07  0.22  0.18" lower="0.0" upper="1.0"/>-->
<!--        </samplingProbability>-->
<!--        <treatmentProbability>-->
<!--            <parameter id="bdss2.treatmentProbability" value ="0.89 0.93 0.79" lower="0.0" upper="1.0"/>-->
<!--        </treatmentProbability>-->
<!--        <origin>-->
<!--            <parameter id="bdss2.origin" value="6.0" lower="0.0"/>-->
<!--        </origin>-->
<!--        <cutOff>-->
<!--            <parameter value="6.0"/>-->
<!--        </cutOff>-->
<!--        <numGridPoints>-->
<!--            <parameter value="3"/>-->
<!--        </numGridPoints>-->
<!--    </newBirthDeathSerialSampling>-->

<!--    <speciationLikelihood id="speciation2" useNewLoop="true">-->
<!--        <model>-->
<!--            <newBirthDeathSerialSampling idref="new.bdss2"/>-->
<!--        </model>-->
<!--        <speciesTree>-->
<!--            <treeModel idref="treeModel"/>-->
<!--        </speciesTree>-->
<!--    </speciationLikelihood>-->

<!--    <speciationLikelihoodGradient id="grad.birthRate2" wrtParameter="birthRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation2"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.deathRate2" wrtParameter="deathRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation2"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.samplingRate2" wrtParameter="samplingRate" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation2"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.samplingProbability2" wrtParameter="samplingProbability" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation2"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->

<!--    <speciationLikelihoodGradient id="grad.treatmentProbability2" wrtParameter="treatmentProbability" useNewLoop="true">-->
<!--        <speciationLikelihood idref="speciation2"/>-->
<!--        <treeModel idref="treeModel"/>-->
<!--    </speciationLikelihoodGradient>-->


<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.birthRate2"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.deathRate2"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.samplingRate2"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.samplingProbability2"/>-->
<!--    </report>-->

<!--    <report>-->
<!--        <speciationLikelihoodGradient idref="grad.treatmentProbability2"/>-->
<!--    </report>-->

</beast>