<?xml version="1.0" standalone="yes"?>

<!-- Generated by BEAUTi v1.10.5 Prerelease #23570d1                         -->
<!--       by Alexei J. Drummond, Andrew Rambaut and Marc A. Suchard         -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       David Geffen School of Medicine, University of California, Los Angeles-->
<!--       http://beast.community/                                           -->
<beast version="1.10.5">

    <taxa id="taxa">
        <taxon id="A"/>
        <taxon id="B"/>
        <taxon id="C"/>
        <taxon id="D"/>
        <taxon id="E"/>
        <taxon id="F"/>
    </taxa>

    <newick id="startingTree" usingHeights="true" usingDates="false">
    (((((A:1.0,B:1.0),C:1.0):1.0),D:1.0):1.0,(E:1.0,F:1.0):1.0);
    </newick>

    <!-- Generate a tree model                                                   -->
    <treeModel id="treeModel">
        <newick idref="startingTree"/>
        <rootHeight>
            <parameter id="treeModel.rootHeight"/>
        </rootHeight>
        <nodeHeights internalNodes="true">
            <parameter id="treeModel.internalNodeHeights"/>
        </nodeHeights>
        <nodeHeights internalNodes="true" rootNode="true">
            <parameter id="treeModel.allInternalNodeHeights"/>
        </nodeHeights>
    </treeModel>

    <!-- FALSE, AB is not sister to CD -->
    <cladeRelationshipStatistic id="test1" relationshipType="sister">
        <treeModel idref="treeModel"/>
        <taxaA>
            <taxa>
                <taxon idref="A"/>
                <taxon idref="B"/>
            </taxa>
        </taxaA>
        <taxaB>
            <taxa>
                <taxon idref="C"/>
                <taxon idref="D"/>
            </taxa>
        </taxaB>
    </cladeRelationshipStatistic>

    <!-- TRUE, ABCD is sister to EF -->
    <cladeRelationshipStatistic id="test2" relationshipType="sister">
        <treeModel idref="treeModel"/>
        <taxaA>
            <taxa>
                <taxon idref="A"/>
                <taxon idref="B"/>
                <taxon idref="C"/>
                <taxon idref="D"/>
            </taxa>
        </taxaA>
        <taxaB>
            <taxa>
                <taxon idref="E"/>
                <taxon idref="F"/>
            </taxa>
        </taxaB>
    </cladeRelationshipStatistic>

    <!-- TRUE, the clade defined by CD includes AB -->
    <cladeRelationshipStatistic id="test3" relationshipType="aInB">
        <treeModel idref="treeModel"/>
        <taxaA>
            <taxa>
                <taxon idref="A"/>
                <taxon idref="B"/>
            </taxa>
        </taxaA>
        <taxaB>
            <taxa>
                <taxon idref="C"/>
                <taxon idref="D"/>
            </taxa>
        </taxaB>
    </cladeRelationshipStatistic>

    <!-- FALSE, the clade defined by AB does not include CD -->
    <cladeRelationshipStatistic id="test4" relationshipType="aInB">
        <treeModel idref="treeModel"/>
        <taxaA>
            <taxa>
                <taxon idref="C"/>
                <taxon idref="D"/>
            </taxa>
        </taxaA>
        <taxaB>
            <taxa>
                <taxon idref="A"/>
                <taxon idref="B"/>
            </taxa>
        </taxaB>
    </cladeRelationshipStatistic>

    <assertEqual tolerance="1e-16" verbose="true" charactersToStrip="\[\],">
        <message>
            AB is not sister to CD
        </message>
        <actual regex="test1:\s(.*?)\n">
            <report>
                <cladeRelationshipStatistic idref="test1"/>
            </report>
        </actual>
        <expected>
            0.0
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-16" verbose="true" charactersToStrip="\[\],">
        <message>
            ABCD is sister to EF
        </message>
        <actual regex="test2:\s(.*?)\n">
            <report>
                <cladeRelationshipStatistic idref="test2"/>
            </report>
        </actual>
        <expected>
            1.0
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-16" verbose="true" charactersToStrip="\[\],">
        <message>
            the clade defined by CD includes AB
        </message>
        <actual regex="test3:\s(.*?)\n">
            <report>
                <cladeRelationshipStatistic idref="test3"/>
            </report>
        </actual>
        <expected>
            1.0
        </expected>
    </assertEqual>

    <assertEqual tolerance="1e-16" verbose="true" charactersToStrip="\[\],">
        <message>
            the clade defined by AB does not include CD
        </message>
        <actual regex="test4:\s(.*?)\n">
            <report>
                <cladeRelationshipStatistic idref="test4"/>
            </report>
        </actual>
        <expected>
            0.0
        </expected>
    </assertEqual>


</beast>
