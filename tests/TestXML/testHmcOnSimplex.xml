<?xml version="1.0" standalone="yes"?>
<!-- Generated by BEAUTi v1.5.4                                              -->
<!--       by Alexei J. Drummond and Andrew Rambaut                          -->
<!--       Department of Computer Science, University of Auckland and        -->
<!--       Institute of Evolutionary Biology, University of Edinburgh        -->
<!--       http://beast.bio.ed.ac.uk/                                        -->
<beast>

	<parameter id="simplex" value="0.2 0.3 0.5" lower="0 0 0" upper="1 1 1"/>
	
	<dirichletParameterPrior id="likelihood">
		<data>
			<parameter idref="simplex"/>
		</data>
		<countsParameter>
			<parameter value="2 6 2"/>
		</countsParameter>
	</dirichletParameterPrior>
	
	<dummyModel id="dummy">
		<parameter idref="simplex"/>
	</dummyModel>

  
  	<gradient id="gradient">
  		<dirichletParameterPrior idref="likelihood"/>
  	</gradient>
  	
  	<report>
  		<gradient idref="gradient"/>
  	</report>
  
    <operators id="operators" optimizationSchedule="log">
	
<!-- 
		<deltaExchange weight="1" delta="0.1">
			<parameter idref="simplex"/>
		</deltaExchange>
 -->
		
      <hamiltonianMonteCarloOperator weight="1" nSteps="5" stepSize="0.01" mode="vanilla"
                                       drawVariance="1.0" 
                                       gradientCheckCount="1000" 
                                       gradientCheckTolerance="0.5">

			<gradient idref="gradient"/>
 			<parameter idref="simplex"/>
 			<UnitSimplexTransform dimension="3"/>
        </hamiltonianMonteCarloOperator>
	</operators>

	<mcmc id="mcmc" chainLength="10000" autoOptimize="true"> 
		<joint id="joint">
			<dirichletParameterPrior idref="likelihood"/>
			<dummyModel idref="dummy"/>
		</joint>

		<operators idref="operators"/>

		<log id="screenLog" logEvery="100">
			<column label="Posterior" dp="4" width="12">
				<posterior idref="joint"/>
			</column>
			<column label="heritability" dp="4" width="12">
				<parameter idref="simplex"/>
			</column>
		</log>
				
		<log id="fileLog" logEvery="10" fileName="testSimplex.log">
			<parameter idref="simplex"/>
		</log>
						
	</mcmc>
	
	 <traceAnalysis id="traceAnalysis" fileName="testSimplex.log" stdError="true"/>	
	
</beast>
