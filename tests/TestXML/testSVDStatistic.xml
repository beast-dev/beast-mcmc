<?xml version="1.0" standalone="yes"?>
<beast>

    <matrixParameter id="L">
        <parameter value="0.00761777  -0.548401  -0.78493    0.306115  -0.216298"/>
        <parameter value="0.0570252    0.351526   0.245018  -1.03049   -2.13245"/>
    </matrixParameter>

    <svdStatistic id="svdStat">
        <matrixParameter idref="L"/>
    </svdStatistic>

    <report>
        <svdStatistic idref="svdStat"/>
    </report>

    <assertEqual tolerance="1e-5" verbose="true" charactersToStrip="\[\],">
        <message>
            Check svd
        </message>
        <actual regex="values:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            2.4100029812397232 1.022446556840847
            0.0234733  0.157104 0.117894 -0.43343  -0.879208
            0.0102419 -0.51842 -0.754695  0.248404 -0.316018
        </expected>
    </assertEqual>

    <assertEqual verbose="true">
        <message>
            Check svd dim names
        </message>
        <actual regex="dimension names:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            svdStat.sv1 svdStat.sv2 svdStat.V11 svdStat.V12 svdStat.V13 svdStat.V14 svdStat.V15 svdStat.V21 svdStat.V22 svdStat.V23 svdStat.V24 svdStat.V25
        </expected>
    </assertEqual>

    <mcmc id="mcmc" chainLength="1" autoOptimize="true">
        <posterior id="posterior">
            <dummyLikelihood>
                <parameter idref="L"/>
            </dummyLikelihood>
        </posterior>
        <operators>
            <fireParameterChanged weight="1"
                                  value="-0.393023  -0.0594516   1.40614   -1.01444  -0.222168
                                          1.71295    0.207991   -0.816126   1.05687  -0.174382">
                <parameter idref="L"/>
            </fireParameterChanged>
        </operators>
        <log id="screenLog" logEvery="100">
            <column label="Posterior" dp="4" width="12">
                <posterior idref="posterior"/>
            </column>
        </log>
    </mcmc>


    <assertEqual tolerance="1e-5" verbose="true" charactersToStrip="\[\],">
        <message>
            Check svd
        </message>
        <actual regex="values:\s*(.*)\n">
            <svdStatistic idref="svdStat"/>
        </actual>
        <expected>
            2.6410930455014583 1.0145059908277
            0.606059  0.0762813  -0.568481   0.551091  -0.00152952
            0.715266  0.0776536   0.614828  -0.163901  -0.278365
        </expected>
    </assertEqual>

    <matrixParameter id="L2">
        <parameter value="0.0026956156957251287 0.298249435069061 -0.2817096154835924 -0.06520276406704728 -0.12124501222818398 -0.07353839888722838 -0.1379022560393122 -0.09680504438209218 -0.23477638062862755 -0.31996085597309404 0.349924814905193 0.2692523852281725 0.14120507872570953 0.06933066071239846 -0.11885543229762202 0.09919658289428224 0.269770109878163 0.2928638776283523 0.4377662390090439 0.3972057501781008 0.1351991062695288 0.11925716622412581 -0.03224831115038561 0.30851464090604774 0.11314020564290753 0.42336263519367356 -0.016667300960657633 0.08864323227527446 0.21658585972403013 0.4025534307807801 -0.06027574444980657 -0.13174863875141157 -0.09730868208888568 0.0721404249060629 0.6667480288029664 -0.21317995787957128 -0.1735594834951847 -0.1944295329092507 -0.4044966084723345 -0.46582700989826126 -0.2874889880550996 -0.1068048207325884 -1.4018974586999158 -1.6306311602785146 -1.474311529000056 -1.1582568582623602 -1.5530885083320733 -1.6516935845938694 0.4755790052838057 0.4480261553394299 0.009479872864192301 0.25809752301914474 0.45040626787943794 0.13524335341041982 0.05437105136145952 0.2633568525130183 0.44730684109500474 -0.021115060819117147 -0.08893985749324014 -0.3241283191737753 -0.31518846807312445 -0.507455531492871 -0.8496016338044737 0.213904765825312 0.7300397923915154 0.5236388951385986 0.09360901103634525 0.1625639311653516 0.06629224656614344 0.3238730304405928 0.015412702573436216 0.28798698709686055 0.322929592478649 0.18210717385884703 0.28918648749501313 0.15848492490898242 -0.21224936150976212 0.44859133641382887 0.12960401415240094 -0.07498577910961925 0.24911641347150593 -0.20726298267621152"/>
        <parameter value="0.0 0.03861077585221479 -0.24398583387641593 0.8864658347753773 0.5404330107807688 0.7666436692441027 0.8073626813920745 0.8170822243022655 0.7144798151618404 0.5311541623427375 0.6567924918259882 0.4360748382941615 0.45619585653597994 -0.03605977503943903 0.1491192694058931 0.580768786546064 0.24598831968377843 0.9358499509059752 0.3867815520010474 0.6412519866293873 0.41661747842019714 0.7860328690403339 0.2853623967673049 0.6707080822696389 0.23788165877369077 0.5315356401481652 0.6562875285630889 0.6306397056407052 0.5418728866698903 0.12598173239007196 -0.4602433468303453 -0.5226641315477184 -0.26985796449230554 -0.2911512848622919 0.05082072578349747 0.5856688776583218 0.43598249615096973 0.7084228297687967 0.5270660574056228 0.4172564343452448 0.2057954178975014 0.1342655234506775 0.35605367411233063 0.24557410620765374 0.07953287748356916 0.4428659725148923 0.22825869027800094 0.05183052600867176 0.5103878971710432 1.0854544522208558 0.8725030836366349 0.7978449848983216 0.7511338444014736 0.9054764531888349 0.6650630783816349 0.912862335642771 0.6630959227304356 0.7665030419357073 0.7945679903627794 0.7681106497109237 0.7523604352030998 0.38829019082061245 0.18537709777501477 -0.23128020637819838 -0.37513678076969914 -0.02453686276432241 0.11936343174548347 -0.3682718791317783 -0.33119565052602 0.19133429138108682 -0.3163842635050171 -0.03558242793040209 0.2618931237246497 0.2752974164174968 0.2902947015264664 0.5361328937463039 0.2050079190921258 0.32930770412503346 0.145107541272317 0.18664181896766624 -0.2799405448991259 0.5332905796202052"/>
    </matrixParameter>

    <svdStatistic id="svdStat2">
        <matrixParameter idref="L2"/>
    </svdStatistic>

    <report>
        <svdStatistic idref="svdStat2"/>
    </report>

    <assertEqual tolerance="1e-3" toleranceType="relative" verbose="true" charactersToStrip="\[\],">
        <message>
            Check svd
        </message>
        <actual regex="values:\s*(.*)\n">
            <svdStatistic idref="svdStat2"/>
        </actual>
        <expected>
            4.710064058936969
            4.455026516431272
            8.23195443467064e-5 0.0009957709667436274 0.04265936276611002 -0.18824083051864882 -0.11724952972675164 -0.16332032036871705 -0.17384109407143494 -0.17462816552738974 -0.15728444297233948 -0.12136845620761649 -0.12730834400031377 -0.08339837365463483 -0.09153621986598276 0.009693529071216931 -0.03496013673092454 -0.11899230726126285 -0.043444704518109986 -0.18768186062512993 -0.0678955494778438 -0.12259934837322783 -0.08340407304288772 -0.16150641023356682 -0.06094047098837254 -0.13149665609492422 -0.04652467838477695 -0.09874876379833063 -0.1383973526234288 -0.12979264754602005 -0.10723526934273399 -0.014175912456837312 0.09485805707612012 0.10579022630667681 0.053726482751707605 0.0633749748065409 0.00968374055782123 -0.1295612852062506 -0.09690169779801629 -0.1547797241449946 -0.12309110962029068 -0.10189264106560304 -0.052017782206712576 -0.03147130618355547 -0.11761973019457897 -0.10139271749078138 -0.06173312319528574 -0.12841893328888998 -0.09538666511197903 -0.06132970786171029 -0.09271094758882699 -0.21437590889179556 -0.18302652504761635 -0.15974822842127778 -0.1440612665988461 -0.18611374414824972 -0.1380717359506973 -0.18375317492911467 -0.1256588350395475 -0.1616898539844715 -0.16965765479547507 -0.17128113057302796 -0.1676989461338817 -0.09707799415032237 -0.06489378950324727 0.05512508989024902 0.1011117624445717 0.02114632903562571 -0.022220023847988376 0.08233966896155334 0.07160984604868183 -0.030309485637114022 0.06694414533885316 0.016270631135090308 -0.04516296014729592 -0.0522797285705742 -0.05216069077313274 -0.10780358054641219 -0.04955463494129997 -0.055489507925133255 -0.026529726990948462 -0.04150405383609707 0.06642410554606192 -0.11837572268457605
            0.000598780924251499 0.06749717687954894 -0.07045401333895836 0.014137332214004513 -0.009483614077587951 0.00841708276867127 -0.0045654757856729185 0.004877316330974096 -0.02908312834059681 -0.05392422720544558 0.09893485053777494 0.07388876043930546 0.04609506932828775 0.014236272292643857 -0.021586979948152257 0.04078569162560019 0.06786652742199067 0.09526962362052444 0.109729471299386 0.10893568237524869 0.04348310530279249 0.05186904429671865 0.0020500014131459984 0.09018563632464441 0.03281236939732943 0.11120358703765186 0.01748692221310386 0.04005162034553665 0.06560572358138728 0.0934872767166684 -0.028248801382744975 -0.04614052755039751 -0.030328094958675746 0.00662438703044046 0.14974650734401812 -0.028444743877527583 -0.02447664720214224 -0.02031638513302191 -0.07283426414620359 -0.09000304564631695 -0.057215913304158136 -0.01938973662803644 -0.2999097227498672 -0.35428566610766565 -0.3249230622020715 -0.2429866231162211 -0.3376200621019024 -0.3652196019783379 0.12211969568132143 0.1345662513298474 0.030275882987134007 0.08309122132440919 0.12430089352239972 0.05927649866895769 0.0335501039515655 0.08797299587655001 0.12076997361902574 0.020057412575377038 0.005897514703173329 -0.0471994466645895 -0.04572214483041312 -0.10018526775334072 -0.18273802665078231 0.040047730387915044 0.15005290230445575 0.1155244374517923 0.024647334095987475 0.024220331145981246 0.004032428909546881 0.07811989617771159 -0.006791307671738775 0.06282212298956158 0.0801884295100008 0.04934012486312335 0.07361001457891296 0.05251435630658296 -0.04052825433360608 0.11027843381526349 0.033474143224250665 -0.010630678598485679 0.04629826949435193 -0.028821511810959745
        </expected>
    </assertEqual>


</beast>

